!function(){"use strict";function t(t,e,n,o,i,r){this.isAuthenticated=function(){return o.isAuthenticated()},this.logout=function(){o.deleteToken(),n.path(r)},this.login=function(n){var r=t.defer();return e.post(i,n).then(function(t){o.setToken(t.data.token),r.resolve(t)},function(t){r.reject(t)}),r.promise}}var e=angular.module("JwtAuth",["ngStorage"]);module.exports=e,e.provider("JwtAuth",function(){var e=null;this.loginUrl="",this.logoutRedirect="",this.$get=["$q","$http","$location","AuthToken",function(n,o,i,r){return null===e&&(e=new t(n,o,i,r,this.loginUrl,this.logoutRedirect)),e}]}),e.service("AuthToken",["$window","$localStorage",function(t,e){var n=this,o=e.token;this.setToken=function(t){e.token=t,o=t},this.getToken=function(){return o?o=e.token:null},this.deleteToken=function(){void 0!==e.token&&(o=void 0,delete e.token)},this.isAuthenticated=function(){var e=n.getToken(),o=!1;if(e&&3===e.split(".").length){var i=e.split(".")[1],r=i.replace(/-/g,"+").replace(/_/g,"/"),u=JSON.parse(t.atob(r)).exp;if(u){var c=Math.round((new Date).getTime()/1e3)>=u;c?n.deleteToken():o=!0}}return o}}]),e.factory("HttpAuthInterceptor",["AuthToken",function(t){function e(t){this.request=function(e){var n=t.getToken();return""!==n&&(e.headers.Authorization="Bearer "+n),e},this.response=function(t){return t}}return new e(t)}]),e.config(["$httpProvider",function(t){t.interceptors.push("HttpAuthInterceptor")}])}();